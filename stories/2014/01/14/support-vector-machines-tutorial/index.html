<!DOCTYPE html>
<html lang="en">
  <head>
    <link href='http://fonts.googleapis.com/css?family=Noticia+Text:400,700' rel='stylesheet' type='text/css' />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title> Метод Опорных Векторов | Vova Zaytsev </title>

    <link rel="stylesheet" href="/theme/css/style.css" type="text/css" />
    <link rel="stylesheet" href="/theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="/theme/css/font-awesome.css" type="text/css"/>
    
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
      "HTML-CSS": {
      styles: {
      ".MathJax .mo, .MathJax .mi": {color: "black ! important"}}
      },
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']],processEscapes: true}
      });
      MathJax.Hub.Register.StartupHook("HTML-CSS Jax Ready",function () {
      var VARIANT = MathJax.OutputJax["HTML-CSS"].FONTDATA.VARIANT;
      VARIANT["normal"].fonts.unshift("MathJax_SansSerif");
      VARIANT["bold"].fonts.unshift("MathJax_SansSerif-bold");
      VARIANT["italic"].fonts.unshift("MathJax_SansSerif-italic");
      VARIANT["-tex-mathit"].fonts.unshift("MathJax_SansSerif-italic");
      });
      MathJax.Hub.Register.StartupHook("SVG Jax Ready",function () {
      var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;
      VARIANT["normal"].fonts.unshift("MathJax_SansSerif");
      VARIANT["bold"].fonts.unshift("MathJax_SansSerif-bold");
      VARIANT["italic"].fonts.unshift("MathJax_SansSerif-italic");
      VARIANT["-tex-mathit"].fonts.unshift("MathJax_SansSerif-italic");
      });
    </script>

    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    
    
    
  </head>
  <body>
    <div class=container>

      <div class=navigation>
        <ul>
            <li><a href="/index.html">Stories</a> </li>
            <li><a href="/tags.html">Tags</a> </li>
            <li><a href="/pages/about-me.html">About</a> </li>
        </ul>
      </div>
      <div class=separator></div>        
        <div class=body>
    <h1 class="title"> Метод Опорных Векторов</h1>
    <p class=date> Tue 14 January 2014 </p>
    <p>Метод опорных векторов (support vector machines, <a class="reference external" href="http://homepages.rpi.edu/~bennek/class/mmld/papers/svn.pdf">SVM</a>) - один из наиболее часто используемых алгоритмов машинного обучения. Во первых, он позволяет решать как задачи классификации так и задачи регрессии. Во вторых, с помощью правильно подобранной функции ядра (<a class="reference external" href="http://en.wikipedia.org/wiki/Kernel_trick">kernel trick</a>), позволяет строить нелинейные разделяющие плоскости, или приблежать нелинейные функции в случае регрессии. Также, для метода доказанны некоторые теоретические гарантии  обобщающих свойств построенных им моделей.</p>
<p>SVM можно применять для многих прикладных задач: парсить текст на естественных языках, распозновать визуальные образы, определять части речи в тексте, делать кредитный скоринг, сортировать поисковую выдачу по релевантности и много всего другого интересного.</p>
<p>Ниже я постараюсь по шагам объяснить базовую теорию лежащую в основе алгоритма (минимизируя колличество греческих букв) и привести пример кода на языке Python, который реализует бинарный классификатор с помощью метода опорных векторов. Затем, мы применим нашу реализацию для решения задачи распознования цифр (<a class="reference external" href="http://en.wikipedia.org/wiki/Handwriting_recognition">digit recognition</a>). Я выбрал эту задачу как одну из самых очевидных и не требующих каких либо специфичных знаний о предметной области.</p>
<div class="section" id="id2">
<h2>Введение</h2>
<p>Допустим, у нас есть набор данных с различными изображениями рукописных цифр (назовем этот набор множеством $\{x_n\}$) и набор c  ответами, где указано какая цифра соответствует какому изображению (множество $\{y_n\}$). Элементы множества $\{x_n\}$, то есть изображения цифр, будут представленны как вектора $x_n \in R^D$. Например, если у нас в наборе изображения 16x16 пикселей, то $D=256$, то есть каждый элемент такого вектора будет кодировать цвет соответвующего пикселя (от 0 до 1, где 0 - значит черный, а 1 - белый). Элементы множества $\{y_n\}$, ответы (или <em>&quot;классы&quot;</em>) – целые числа от 0 до 9.</p>
<img alt="" class="align-center" src="{filename}/images/svm-intro_digit_recognition.png" />
<p>Теперь мы хотим найти такую функцию $f$, которая бы по заданному $x$, вычисляла значение $y$, при этом нам интересно чтобы найденная функция могла работать не только с изображенниями из нашего набора, но и с новыми изображениями (то есть, могла бы сделать какое-то обобщение от том как выглядят рукописные цифры на основе небольшой выборки имеющихся у нас цифр).</p>
</div>
<div class="section" id="id3">
<h2>Функция потерь</h2>
<p>Допустим, переменная которую мы хотим спрогнозировать, принимает одно из двух значений $y \in \{-1, + 1\}$ и решающее правило классификатора имеет вид: $h(x) = SIGN(f(x))$, где $f(x)=w^T\phi(x) + b$. Функция потерь SVM имеет следующий вид:</p>
<p>\[
l(f(x), y) =
\begin{cases}
0, &amp; \text{если $y~f(x) \geqslant 1$;} \\
1 - y~f(x), &amp; \text{в противном случае.}
\end{cases}
\]</p>
<p>Интуитивно можно понять, что мы платим 0 долларов, если наш прогноз для $y$ совпадает с истинным значением по знаку и больше или равен ему по модулю, иначе мы платим тем больше, чем сильнее наш прогноз отличается от истинного значения.</p>
<p>Более компактно функцию потерь можно переписать следующим образом:</p>
<p>$$
l^{HINGE}(f(x), y) = max(0, 1 - y~f(x))
$$</p>
<p>Теперь допустим, что вместо одной пары точек, у нас есть множество $\{x_n\}$ и $\{y_n\}$. В таком случае суммарное значение потерь на этом множестве будет:</p>
<p>$$
L(w, \lambda) = \sum_n{max(0, 1 - y_n [w^T \phi(x_n) + b])} + \frac{\lambda}{2}||w||^2_2
$$</p>
<p>Здесь $w$ и $b$ - параметры нашей линейной модели, $\lambda$ - некоторый параметр регуляризации. Оптимизация функции потерь приведет к уменьшению ошибок классификации на нашем множистве. Также, можно заметить, что такая функция потерь &quot;штрафует&quot; нашу модель за слишком большие значения параметров. Другими словами, если у нас есть две модели $w_1$ и $w_2$ и $||w_1||$ &gt; $||w_2||$, то с точки зрения данной функции потерь, вторая, &quot;более простая&quot; модель, – лучше первой; насколько лучше - зависит от параметра $\lambda$, который не участвует в задаче оптимизации.</p>
</div>

    
<div class=twitter>
<a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div>
    <p class=tags>This entry was tagged as
      <a href="/tag/svm.html">svm</a>
      <a href="/tag/ml.html">ml</a>
      <a href="/tag/algorithm.html">algorithm</a>
      <a href="/tag/kernel.html">kernel</a>
    </p>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'zaycevgithub'; // required: replace example with your forum shortname
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
        
<div class=footer>
  <p>&copy; Copyright <script language="JavaScript">var date = new Date(); document.write(date.getFullYear());</script> by Vladimir Zaytsev</p>
  <p> Powered by <a href="http://pypi.python.org/pypi/pelican/" target="_blank">Pelican</a>.  
    <a href="https://github.com/fjavieralba/flasky">Theme</a>  by <a href="http://fjavieralba.com">fjavieralba</a>
  </p> 
  <p>
    <div class=social style="font-size: 27px;">
      <ul>
        <script language="JavaScript">
          u = 'zaytsev';
          s = 'usc.edu';
          document.write('<a href=\"mailto:' + u + '@' + s + '\" target=\"_blank\">');
        </script>
            <li><i class="icon-envelope icon-large"></i> </li>
        </a>
        <a href="http://twitter.com/vladimirzaytsev" target="_blank"> <li> <i class="icon-twitter-sign icon-large"> </li></i> </a>
        <a href="http://www.linkedin.com/pub/vladimir-zaytsev/2b/32a/106"><li><i class="icon-linkedin-sign icon-large" ></i></li></a>
        <a href="http://github.com/zaycev" target="_blank"> <li> <i class="icon-github-sign icon-large"></i> </li> </a>
        <a href="/feeds/all.rss.xml" rel="alternate" title="Recent Blog Posts"><li> <i class="icon-rss icon-large"></i> </li></a>
      </ul>
    </div>
  </p>
</div>    </div>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-47310787-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
